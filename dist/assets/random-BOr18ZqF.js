import{R as c,a as w,j as i,r as f,b as S}from"./index-D05ayUoB.js";const U=c.memo(()=>{var t;const{status:e,reload:n}=w();return!e.partial&&!e.error?null:i.jsxs("div",{className:"card",role:"status","aria-live":"polite",style:{marginBottom:12},children:[e.error?i.jsx("div",{className:"error",children:"Some data failed to load. The app is using fallback datasets."}):i.jsx("div",{className:"notice",children:"Running with partial data (fallbacks)."}),i.jsxs("div",{style:{fontSize:12,opacity:.8},children:["Details: ",(t=e.details)==null?void 0:t.join(", ")]}),i.jsx("div",{style:{marginTop:8},children:i.jsx("button",{onClick:n,children:"Retry loading"})})]})}),_=c.memo(({disabled:e,onSubmitGuess:n})=>{const[t,r]=c.useState(""),a=c.useCallback(s=>{s.preventDefault(),t.trim()&&(n(t),r(""))},[n,t]);return i.jsxs("form",{onSubmit:a,className:"row","aria-label":"Guess form",children:[i.jsx("input",{id:"guess-input",type:"text","aria-label":"Enter your guess",placeholder:"Type a player name…",value:t,onChange:s=>r(s.target.value),disabled:e}),i.jsx("button",{type:"submit",disabled:e,children:"Guess"})]})}),B=c.memo(({disabled:e,onHint:n,onGiveUp:t})=>i.jsxs("div",{className:"row",children:[i.jsx("button",{onClick:n,disabled:e,"aria-disabled":e,children:"Hint (-1)"}),i.jsx("button",{onClick:t,disabled:e,"aria-disabled":e,children:"Give Up"})]})),N=c.memo(({enabled:e,onSubmit:n,onHint:t,onGiveUp:r})=>(c.useEffect(()=>{if(!e)return;const a=c.useCallback(s=>{if(s.key==="Enter"&&n(),s.key.toLowerCase()==="h"&&t(),s.key.toLowerCase()==="g"&&r(),s.key==="/"){const o=document.getElementById("guess-input");o==null||o.focus(),s.preventDefault()}},[n,t,r]);return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[e,n,t,r]),i.jsxs("div",{style:{fontSize:12,opacity:.7},children:["Shortcuts: ",i.jsx("kbd",{children:"/"})," focus, ",i.jsx("kbd",{children:"Enter"})," submit, ",i.jsx("kbd",{children:"H"})," hint, ",i.jsx("kbd",{children:"G"})," give up."]})));function x(){const[e,n]=f.useState(Date.now()),t=f.useRef(!1),r=f.useRef(null);f.useEffect(()=>{const s=()=>{t.current=document.hidden,document.hidden||a()};return document.addEventListener("visibilitychange",s),()=>document.removeEventListener("visibilitychange",s)},[]);function a(){n(Date.now()),r.current=window.setTimeout(a,1e3)}return f.useEffect(()=>(a(),()=>{r.current&&clearTimeout(r.current)}),[]),[e,document.hidden]}const $=c.memo(({deadlineMs:e,onTimeout:n})=>{const[t,r]=c.useState(0),[,a]=x(),s=c.useRef(n);return s.current=n,S(c.useCallback(o=>{if(a)return;const l=Math.max(0,Math.floor((e-o)/1e3));r(l),l<=0&&s.current()},[e,a]),!0),c.useEffect(()=>{const o=Date.now(),l=Math.max(0,Math.floor((e-o)/1e3));r(l)},[e]),i.jsxs("div",{"aria-live":"polite","aria-atomic":"true",children:["⏱️ Time left: ",i.jsxs("strong",{children:[t,"s"]})]})});function k(e=new Date){var n,t,r;try{const s=new Intl.DateTimeFormat("en-US",{timeZone:"America/Chicago",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(e),o=((n=s.find(u=>u.type==="year"))==null?void 0:n.value)??String(e.getUTCFullYear()),l=((t=s.find(u=>u.type==="month"))==null?void 0:t.value)??String(e.getUTCMonth()+1).padStart(2,"0"),m=((r=s.find(u=>u.type==="day"))==null?void 0:r.value)??String(e.getUTCDate()).padStart(2,"0");return`${o}-${l}-${m}`}catch{const a=e.getUTCFullYear(),s=String(e.getUTCMonth()+1).padStart(2,"0"),o=String(e.getUTCDate()).padStart(2,"0");return`${a}-${s}-${o}`}}const D=60;function A(e=new Date){return k(e)}function F(){return{tag:"idle"}}function K(e,n){switch(e.tag){case"idle":{if(n.type==="start"){const t=Date.now();return{tag:"active",startedAtMs:t,deadlineMs:t+D*1e3,guesses:[],hintsUsed:0,score:5}}return e}case"active":{if(n.type==="tick")return n.nowMs>=e.deadlineMs?{tag:"revealed",endedAtMs:n.nowMs,reason:"timeout",finalScore:Math.max(0,e.score-1),guesses:e.guesses,hintsUsed:e.hintsUsed}:e;if(n.type==="guess"){const t=[...e.guesses,n.text];return t.length>=3?{tag:"revealed",endedAtMs:Date.now(),reason:"maxGuesses",finalScore:Math.max(0,e.score-1),guesses:t,hintsUsed:e.hintsUsed}:{...e,guesses:t}}return n.type==="hint"?{...e,hintsUsed:e.hintsUsed+1,score:Math.max(0,e.score-1)}:n.type==="reveal"?{tag:"revealed",endedAtMs:Date.now(),reason:n.reason,finalScore:e.score,guesses:e.guesses,hintsUsed:e.hintsUsed}:e}case"revealed":return n.type==="reset"?{tag:"idle"}:e}}const p=3,y=`njt_v${p}_`,d=new Map,j=5*60*1e3,h={recentIds:[],streakBest:0,streakCurrent:0,lastDailyKey:void 0,lastDailyId:void 0,lastPosition:void 0,gameStats:{totalGames:0,totalCorrect:0,averageScore:0,bestStreak:0,positionStats:{QB:{games:0,correct:0},RB:{games:0,correct:0},WR:{games:0,correct:0},TE:{games:0,correct:0}}},preferences:{soundEnabled:!0,animationsEnabled:!0,theme:"auto"},performanceMetrics:{averageGuessTime:0,fastestGuess:1/0,totalGuesses:0}};function v(e){return`${y}${e}`}function C(e){const n=v(e),t=d.get(n);return t?Date.now()>t.timestamp+t.ttl?(d.delete(n),null):t.data:null}function g(e,n,t=j){const r=v(e);if(d.set(r,{data:n,timestamp:Date.now(),ttl:t}),d.size>100){const a=Date.now();for(const[s,o]of d.entries())a>o.timestamp+o.ttl&&d.delete(s)}}function T(e){return JSON.stringify(e)}function R(e){return JSON.parse(e)}function b(){const e=C("state");if(e)return e;try{const t=localStorage.getItem(y+"state");if(t){const r={...h,...R(t)};return g("state",r),r}for(let r=p-1;r>=1;r--){const a=localStorage.getItem(`njt_v${r}_state`);if(a){const s=JSON.parse(a),o={...h,recentIds:s.recentIds??s.njt_recent_ids??[],streakBest:s.streakBest??s.njt_streak_best??0,streakCurrent:s.streakCurrent??s.njt_streak_current??0,lastDailyKey:s.lastDailyKey,lastDailyId:s.lastDailyId,lastPosition:s.lastPosition};return E(o),o}}}catch(t){console.warn("Failed to load state from storage:",t)}const n={...h};return g("state",n),n}function E(e){try{const t={...b(),...e},r=T(t);localStorage.setItem(y+"state",r),g("state",t)}catch(n){console.warn("Failed to save state to storage:",n)}}function M(){try{for(let e=1;e<p;e++){const n=`njt_v${e}_state`;localStorage.removeItem(n)}}catch(e){console.warn("Failed to cleanup old storage versions:",e)}}M();function O(e){if(e<=0)return 0;if(crypto&&"getRandomValues"in crypto){const n=new Uint32Array(1);crypto.getRandomValues(n);const t=n[0];if(t!==void 0)return t%e}return Math.floor(Math.random()*e)}function G(e,n){let t=2166136261;for(let a=0;a<n.length;a++)t^=n.charCodeAt(a),t=Math.imul(t,16777619);t^=t<<13,t^=t>>>17,t^=t<<5;const r=(t>>>0)/4294967296;return Math.floor(r*e)}function L(e,n){var m;const t=["QB","RB","WR","TE"],r=n[n.length-1],a=Math.max(0,t.indexOf(r??"QB")),s=t.slice(a+1).concat(t.slice(0,a+1)),o=new Map;for(const u of t)o.set(u,[]);for(const u of e)(m=o.get(u.position))==null||m.push(u);const l=[];for(const u of s)l.push(...o.get(u)??[]);return l.length?l:e}export{U as D,_ as G,B as H,N as K,$ as T,L as a,O as b,k as c,A as d,G as e,F as i,b as l,K as r,E as s};
