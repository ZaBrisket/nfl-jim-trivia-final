import{R as a,a as y,i as v,j as s,L as h}from"./index-COQNCXdJ.js";import{r as p,i as f,c as S,D as w,T as b,G as k,H as N,K as D,d as C,e as T,l as E,s as G}from"./random-B-u04LOh.js";function R(r){const t=C(new Date),i=T(r.length,t),l=r[i];if(!l)throw new Error("No player found for daily pick");return E(),G({lastDailyKey:t,lastDailyId:l.id}),l}const I=a.memo(()=>{const{status:r,data:t}=y(),[i,l]=a.useState(null),[e,n]=a.useReducer(p,void 0,f),[u]=a.useState(S());a.useEffect(()=>{var o;(o=t==null?void 0:t.players)!=null&&o.length&&e.tag==="idle"&&l(R(t.players))},[t,e.tag]);const m=a.useCallback(()=>n({type:"start"}),[]),x=a.useCallback(o=>{if(!i||e.tag!=="active")return;const j=v(o,i);n({type:"guess",text:o}),j&&n({type:"reveal",reason:"solved"})},[i,e.tag]),c=a.useCallback(()=>{e.tag==="active"&&n({type:"hint"})},[e.tag]),d=a.useCallback(()=>{e.tag==="active"&&n({type:"reveal",reason:"giveup"})},[e.tag]),g=a.useCallback(()=>{e.tag==="active"&&n({type:"reveal",reason:"timeout"})},[e.tag]);return s.jsxs("div",{className:"container",children:[s.jsxs("h1",{children:["Daily — ",u]}),s.jsx(w,{}),!r.ready&&s.jsx("div",{className:"card",children:"Loading data…"}),r.ready&&i&&s.jsxs("div",{className:"card",children:[e.tag==="idle"&&s.jsxs("div",{className:"row",children:[s.jsx("button",{onClick:m,children:"Start Daily"}),s.jsx(h,{to:"/",children:"Switch to Endless"})]}),e.tag==="active"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"grow",children:[s.jsx("strong",{children:"Guess today’s player"})," — Position: ",s.jsx("em",{children:i.position})]}),s.jsx(b,{deadlineMs:e.deadlineMs,onTimeout:g})]}),s.jsx("div",{className:"row",style:{marginTop:8},children:s.jsx(k,{disabled:!1,onSubmitGuess:x})}),s.jsx("div",{style:{marginTop:8},children:s.jsx(N,{disabled:!1,onHint:c,onGiveUp:d})}),s.jsx("div",{style:{marginTop:8},children:s.jsx(D,{enabled:!0,onSubmit:()=>{},onHint:c,onGiveUp:d})})]}),e.tag==="revealed"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"grow",children:[s.jsxs("h2",{children:["Answer: ",i.displayName]}),s.jsxs("div",{children:["Reason: ",e.reason]})]}),s.jsxs("div",{children:["Final Score: ",s.jsx("strong",{children:e.finalScore}),"/5"]})]}),s.jsxs("div",{className:"row",style:{marginTop:12},children:[s.jsx("button",{onClick:()=>window.location.reload(),children:"Come back tomorrow"}),s.jsx(h,{to:"/",children:"Play Endless"})]})]})]})]})});export{I as Daily};
